version: "3"
services:
  portainer:
    container_name: portainer
    image: portainer/portainer-ce
    command: -H unix:///var/run/docker.sock
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ${CONF_FOLDER}/portainer/volumes:/var/lib/docker/volumes
    ports:
      - 8000:8000/tcp
      - 5080:9000/tcp
    restart: always

  pihole:
    container_name: pihole
    image: pihole/pihole:latest
    environment:
      TZ: ${TZ}
      WEBPASSWORD: ${PIHOLE_PWD}
      ServerIp: ${PIHOLE_IP}
      IPv6: 'false'
    volumes:
      - ${CONF_FOLDER}/pihole/etc:/etc/pihole
      - ${CONF_FOLDER}/pihole/dnsmasq.d:/etc/dnsmasq.d
    ports:
      - 53:53/tcp
      - 53:53/udp
      - 67:67/udp
      - 5180:80/tcp
    dns:
      - 127.0.0.1
      - 1.1.1.1
    cap_add:
      - NET_ADMIN
    restart: always

  netdata:
    container_name: netdata
    image: netdata/netdata
    hostname: ${NETDATA_MAIN_HOSTNAME} # set to fqdn of host
    volumes:
      - /proc:/host/proc:ro
      - /sys:/host/sys:ro
      - /var/run/docker.sock:/var/run/docker.sock:ro
    cap_add:
      - SYS_PTRACE
    security_opt:
      - apparmor:unconfined
    ports:
      - 5280:19999/tcp
    restart: unless-stopped

  glances:
    container_name: glances
    image: nicolargo/glances:latest-alpine
    pid: host
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      - "GLANCES_OPT=-w"
    ports:
      - 5380:61208/tcp
    restart: unless-stopped

  shellinabox:
    container_name: shellinabox
    image: sspreitzer/shellinabox:latest
    environment:
      SIAB_USER: ${SIAB_USER}
      SIAB_PASSWORD: ${SIAB_PASS}
      SIAB_SUDO: 'true'
      SIAB_SSL: 'false'
    ports:
      - 5480:4200/tcp
    restart: unless-stopped

  samba:
    container_name: samba
    image: dperson/samba
    environment:
      TZ: ${TZ}
      NMBD: 'true'
      USER: ${SAMBA_USER_PASS}
      USERID: '0'
      GROUPID: '0'
      SHARE: ${SAMBA_SHARE}
      SHARE2: ${SAMBA_SHARE2}
      SHARE3: ${SAMBA_SHARE3}
      WORKGROUP: ${SAMBA_WORKGROUP}
    stdin_open: true
    tty: true
    read_only: false
    volumes:
      - ${STORAGE}:/Storage
      - ${DIVX}:/Divx
      - ${DOCKER}:/Docker
    ports:
      - 137:137/udp
      - 138:138/udp
      - 137:137/tcp
      - 138:138/tcp
      - 139:139/tcp
      - 445:445/tcp
    tmpfs:
      - /tmp
    restart: always